# Лабораторная работа №1. MPI

## 1. Цель и задачи
Целью работы является исследование производительности параллельных алгоритмов на основе библиотеки MPI.
- **Задание 1:** Метод Монте-Карло для приближённого вычисления числа π.
- **Задание 2:** Умножение матрицы на вектор с тремя схемами распределения данных (по строкам, по столбцам, по блокам).
- **Задание 3:** Алгоритм Кэннона для умножения квадратных матриц.

## 2. Описание реализованных программ
| Файл | Назначение | Ключевые особенности |
|------|------------|----------------------|
| `distributed_computing_lab_1/src/monte_carlo_pi.c` | Оценка π методом Монте-Карло | Детеминированный генератор LCG, равное распределение итераций, сбор результатов через `MPI_Reduce`. |
| `distributed_computing_lab_1/src/matvec_rows.c` | Разбиение матрицы по строкам | Используются `MPI_Scatterv`/`MPI_Gatherv` для учёта остаточных строк; результат проверяется сериализацией. |
| `distributed_computing_lab_1/src/matvec_cols.c` | Разбиение по столбцам | Предварительная упаковка столбцов на корневом процессе, суммирование вкладов через `MPI_Reduce`. |
| `distributed_computing_lab_1/src/matvec_blocks.c` | Блочное разбиение | Формируется квадратная решётка процессов, редукция по строкам решётки и последующая агрегация результата. |
| `distributed_computing_lab_1/src/matmul_cannon.c` | Алгоритм Кэннона | Использование декартовой топологии, циклические сдвиги блоков, сверка результата последовательным умножением; генерация данных ограничена малыми значениями для предотвращения переполнения. |

## 3. Методика экспериментов
1. Сборка проекта (`make -C distributed_computing_lab_1`)
   ```bash
   mpirun -np 4 build/monte_carlo_pi 1000000
   mpirun -np 4 build/matvec_rows 64 64
   mpirun -np 4 build/matmul_cannon 64
   ```
2. Серии запусков на **2, 4, 8** процессах
3. Рассчёт ускорения и эффективности:
   - `S(p) = T(1) / T(p)`
   - `E(p) = S(p) / p`

## 4. Экспериментальные данные
Ниже приведены фактические результаты замеров.

### 4.1. Метод Монте-Карло (`50000000` выборок)
| Процессов | Время, с | Оценка π | Ускорение | Эффективн. |
|-----------|----------|----------|-----------|------------|
| 1 | 0.889 | 3.14124776 | 1.00 | 1.00 |
| 2 | 0.554 | 3.14135496 | 1.60 | 0.80 |
| 4 | 0.277 | 3.14145792 | 3.20 | 0.80 |
| 8 | 0.148 | 3.14135944 | 5.99 | 0.75 |

### 4.2. Матрица × вектор (`2048 × 2048`)
| Схема | Процессов | Время, с | Ускорение | Эффективн. | Примечание |
|-------|-----------|----------|-----------|------------|------------|
| строки | 1 | 0.96 | 1.00 | 1.00 | baseline |
| строки | 2 | 0.88 | 1.09 | 0.55 | слабое ускорение |
| строки | 4 | 0.92 | 1.04 | 0.26 | |
| строки | 8 | 1.02 | 0.94 | 0.12 | коммуник. накладные расходы |
| столбцы | 1 | 1.00 | 1.00 | 1.00 | baseline |
| столбцы | 2 | 0.92 | 1.09 | 0.54 | |
| столбцы | 4 | 1.00 | 1.00 | 0.25 | |
| столбцы | 8 | 1.11 | 0.90 | 0.11 | деградация |
| блоки | 1 | 0.91 | 1.00 | 1.00 | baseline |
| блоки | 4 | 0.95 | 0.96 | 0.24 | требуется квадрат процессов |
| блоки | 2 / 8 | — | — | — | запуск невозможен, см. логи ошибок |

### 4.3. Алгоритм Кэннона (`1024 × 1024`)
| Процессов | Время, с | Ускорение | Эффективн. | Примечание |
|-----------|----------|-----------|------------|------------|
| 1 | 8.94 | 1.00 | 1.00 | baseline |
| 2 | — | — | — | число процессов не квадратное |
| 4 | 5.88 | 1.52 | 0.38 | корректный запуск |
| 8 | — | — | — | число процессов не квадратное |

Графики (см. каталог `distributed_computing_lab_1/plots/`).
